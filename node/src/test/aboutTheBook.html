<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>About the Book</title>
</head>
<body>
  <h1 id="title"></h1>
  <h3 id="author"></h3>
  <img id="cover" alt="Book cover" />
  <p id="description"></p>
</body>
<script>
  function detectSource(bookId) {
    if (/^OL\d+(W|M|A)$/.test(bookId)) return "openlibrary";
    if (/^\d+$/.test(bookId)) return "gutenberg";
    return "googlebooks"; // fallback if it's alphanumeric
  }

  const urlParams = new URLSearchParams(window.location.search);
  const bookId = urlParams.get("bookId");
  const source = detectSource(bookId);

  switch (source) {
    case "googlebooks":
      fetch(`/api/aboutBook/Google/${bookId}`)   // ðŸ”¥ now calls your backend controller
        .then(res => res.json())
        .then(renderGoogleBook);
      break;
    case "openlibrary":
      fetch(`https://openlibrary.org/works/${bookId}.json`)
        .then(res => res.json())
        .then(renderOpenLibraryBook);
      break;
    case "gutenberg":
      fetch(`https://gutendex.com/books/${bookId}`)
        .then(res => res.json())
        .then(renderGutenbergBook);
      break;
  }

  function renderGoogleBook(data) {
    document.querySelector("#title").textContent = data.title;
    document.querySelector("#author").textContent = data.authors?.join(", ") || "Unknown";
    document.querySelector("#description").innerHTML = data.description || "No description available.";
    document.querySelector("#cover").src = data.cover || "fallback.jpg";
  }
</script>
</html>
